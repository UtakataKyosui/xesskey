## Phase 3: フェデレーションの完成と機能拡充

Phase 1, 2 で構築した基盤を元に、実用的な SNS としての機能を完成させる。
特に「連合（Federation）」としての振る舞いを安定させ、他の主要 SNS 実装との相互運用性を確保する。

### 目標
- 外部インスタンス（Mastodon, Misskey 等への）完全な連合対応。
- リアルタイム性の向上とメディア対応。
- システムの安定性と運用性の向上。

### 実装機能詳細

#### 1. 連合機能の強化
- **Remote Follow**: リモートユーザーを正しくフォローし、相手の承認フロー（Accept Activity）を処理する。
- **Undo / Delete**: 投稿の削除やフォロー解除の Activity を適切に処理・配送する。
- **Shared Inbox**: 配送処理の効率化（同一サーバーへの配送をまとめる）。
- **HTTP Signature 検証の強化**: セキュリティ向上のための厳格な検証。

#### 2. リッチコンテンツ対応
- **メディアアップロード**: 画像や動画のアップロード機能および Object への添付。
- **OGP 対応**: リンクプレビューの生成と表示。

#### 3. UX 向上
- **リアルタイム更新**: WebSocket または Server-Sent Events (SSE) を用いたタイムラインの自動更新。
    - ProtoBuf ストリーミングの活用も検討。
- **検索**: ユーザーや投稿の検索機能（全文検索エンジンの導入検討、または簡易検索）。

#### 4. テストとデバッグ
- **Federation Test**: `activitypub-testsuite` 等を用いたプロトコル準拠テスト。
- **Interoperability**: 実際の Mastodon / Misskey インスタンスとの送受信テスト。

### 将来的な拡張（Phase 4 以降の候補）
- 公開範囲設定（Public, Unlisted, Followers-only, Direct）。
- モデリングツール（通報、ブロック、ドメインブロック）。
- リレーサーバーへの参加。
